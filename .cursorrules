# Cursor Instructions for i18next-cli Reproduction

## Generated Files

**IMPORTANT**: The `en/translation.json` file (and any other `translation.json` files in locale directories) is **generated code** that should **never be manually edited**. These files are automatically generated by the `i18next-cli extract` command and any manual changes will be overwritten.

## Expected vs Actual Pattern

In `src/app.jsx`, each test case follows this pattern:

- **Expected**: Shows what the `translation.json` value should look like based on react-i18next's component index calculation
- **Actual**: Shows the actual value copied from `translation.json` with:
  - ✅ (checkmark) if the actual value matches the expected value exactly
  - ⚠️ (warning) if only the component tag numbers differ (e.g., `<0>` vs `<1>`) but the structure and spacing match
  - ❌ (X mark) if the actual value has structural differences from the expected value (e.g., unwanted spaces, incorrect nesting, missing text)

Example:
```javascript
// Expected: "wo<1>r</1>d"  // Component is 2nd child (index 1)
// Actual: "wo<1>r</1>d" ✅  // Matches expected
// Expected: "In our <2>help article</2>, you will find..."
// Actual: "In our <2>help article</2> , you will find..." ❌  // Has unwanted space before comma
```

This pattern helps track which translation keys are being generated correctly by i18next-cli and which ones have issues (like unwanted spaces, incorrect nesting, etc.).

## Workflow

1. Write test cases in `src/app.jsx` with Trans components
2. Run `npm run extract` to generate/update `translation.json`
3. Compare the generated values with the expected values in the comments
4. Never manually edit `translation.json` - it will be overwritten on the next extraction
5. Run `npm run` to execute the components and see missing keys directly from i18next

## Updating Actual Values

When asked to update the "Actual" values in `src/app.jsx`:

1. Read the current values from `@translation.json` (or `en/translation.json`)
2. For each translation key, find the corresponding "Actual" comment in `src/app.jsx`
3. Update the "Actual" value with the current value from `translation.json`
4. Update the checkmark/warning/X mark:
   - ✅ if the actual value matches the expected value exactly
   - ⚠️ if only the component tag numbers differ (e.g., `<0>` vs `<1>`) but structure and spacing match (Note: This should rarely happen now that expected values are calculated correctly)
   - ❌ if there are structural differences (unwanted spaces, incorrect nesting, missing text, etc.)
5. When calculating expected values, count ALL children sequentially (text nodes, spaces `{" "}`, and components) to determine component indices
6. Ensure the format matches exactly what's in `translation.json` (including component indices, spacing, etc.)

## Anonymization Rules for Examples

When adding examples from production code, **always anonymize** to prevent leakage of company-specific information:

1. **Translation Keys**: Replace company-specific keys with generic `example.*` keys (e.g., `TimeCorrectionsModal.form.vacation.duration.value` → `example.durationValue`)

2. **Company Names**: Replace company/product names with generic placeholders (e.g., "plancraft" → "app", "company", or similar generic terms)

3. **Component Names**: Replace company-specific component names with generic HTML elements or simple component names:
   - Custom components → standard HTML (`<b>`, `<strong>`, `<a>`, etc.) or generic component names (`<Custom>`, `<TextLink>`, etc.)
   - Example: `<ShrkMarker>` → `<b>` or `<Custom>`
   - Example: `<Field>`, `<NumberInput>` → `<div>`, `<input>` or generic components

4. **Text Content**: Replace company-specific text with generic equivalents while preserving:
   - The structure that demonstrates the issue (spacing, nesting, etc.)
   - The same number of text nodes and components
   - The same spacing patterns (`{" "}`, line breaks, etc.)
   - Example: "Welcome to plancraft, {firstName}!" → "Welcome to the app, {name}!"
   - Example: "can affect the absences already recorded by your employees" → "can affect existing records"

5. **Props and Attributes**: Keep generic props (like `className`, `name`, `value`) but remove or anonymize company-specific values:
   - Keep: `className='w-[160px]'` (generic styling)
   - Replace: `i18nKey='TimeCorrectionsModal.form.vacation.duration.value'` → `i18nKey='example.durationValue'`

6. **Preserve Structure**: The anonymized example must still demonstrate the same spacing/numbering issue as the original. The structure (line breaks, component nesting, text nodes) should match exactly.

7. **No Nesting**: Examples should never use nested components within Trans. All components should be direct children of Trans. If the original example has nesting, flatten it while preserving the spacing/numbering issue being demonstrated.

8. **No Separate Namespaces**: Examples should always use the default namespace. Never use `ns` prop to put examples in separate namespaces. All examples should use `example.*` keys in the default translation namespace.

**Goal**: The anonymized example should be indistinguishable from a generic test case while still reproducing the exact same i18next-cli extraction issue.

